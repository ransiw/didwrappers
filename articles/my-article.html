<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Democratization on growth â€¢ didwrappers</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Democratization on growth">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">didwrappers</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/comparison_with_did.html">Comparison between did and didwrappers</a></li>
    <li><a class="dropdown-item" href="../articles/minimum-wage.html">Minimum wage example</a></li>
    <li><a class="dropdown-item" href="../articles/my-article.html">Democratization on growth</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/ransiw/didwrappers/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Democratization on growth</h1>
                        <h4 data-toc-skip class="author">Ransi
Clark</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ransiw/didwrappers/blob/main/vignettes/articles/my-article.Rmd" class="external-link"><code>vignettes/articles/my-article.Rmd</code></a></small>
      <div class="d-none name"><code>my-article.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction-and-setup">Introduction and setup<a class="anchor" aria-label="anchor" href="#introduction-and-setup"></a>
</h2>
<p>This article applies the <code>did</code> and
<code>didwrappers</code> package to a dataset that considers the impact
of democratization on per capita GDP growth. The data for the study is a
subset used by the following paper:</p>
<p>Acemoglu, D., Naidu, S., Restrepo, P., &amp; Robinson, J. A. (2019).
Democracy does cause growth. Journal of political economy, 127(1),
47-100.</p>
<p>The data is only a sample and is not an attempt at replicating the
original paper. The results are purely to demonstrate the functions of
the package.</p>
<p>In a balanced panel, estimates between <code>did</code> and
<code>didwrappers</code> should be the same, although the standard
errors differ. But with unbalanced panels, the estimates can also
differ. This example considers some reasons why, and provides some
guidance on which package might be appropriate to the purposes.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load packages and data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bcallaway11.github.io/did/" class="external-link">did</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ransiw/didwrappers" class="external-link">didwrappers</a></span><span class="op">)</span></span>
<span><span class="va">demgdp</span> <span class="op">=</span> <span class="fu">didwrappers</span><span class="fu">::</span><span class="va"><a href="../reference/demgdp.html">demgdp</a></span></span></code></pre></div>
<p>Some pre-processing needs to be done to be suitable for estimation.
First, the year of democratization is missing for non-democracies.
Replace this with a zero or a year later than the last year of
observation, which is 2010.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">demgdp</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">demgdp</span><span class="op">$</span><span class="va">YearFirstDemocracy</span><span class="op">)</span>,<span class="st">"YearFirstDemocracy"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">0</span></span></code></pre></div>
<p>The estimator assumes a once-treated-always-treated type of
treatment. This is not true of democratization because there can be
democracy reversals and breakdowns. There are several way of
accommodating reversals in a once-treated-always-treated setup. One
would be to remove the country-year records after the first breakdown.
Another would be to remove country-year records that correspond to a
breakdown. An even more different approach would be to change the
identity codes to rename the country each time democracy breaks down.
The approach depends on the type of dynamic effect that might interest
the analyst. I adopt the second approach, removing any reversals.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">demgdp</span> <span class="op">&lt;-</span> <span class="va">demgdp</span><span class="op">[</span><span class="va">demgdp</span><span class="op">$</span><span class="va">breakdown</span><span class="op">==</span><span class="fl">0</span>,<span class="op">]</span></span></code></pre></div>
<p>The country code (<code>wbcode</code>) should be numeric.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">demgdp</span><span class="op">$</span><span class="va">wbnum</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">demgdp</span><span class="op">$</span><span class="va">wbcode</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We must also make the decision about what would be the control group.
The default is those that were never democratized. For demonstration
purposes, I change this to the not yet treated group.</p>
</div>
<div class="section level2">
<h2 id="the-estimates-from-the-did-package">The estimates from the did package<a class="anchor" aria-label="anchor" href="#the-estimates-from-the-did-package"></a>
</h2>
<p>I now produce the estimates from the <code>did</code> package. Before
running the estimator, it would be informative to consider the groups in
the data. A group is determined by the treatment time, or in this case
year of democratization.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">demgdp</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"wbcode"</span>,<span class="st">"YearFirstDemocracy"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">[</span>,<span class="st">"YearFirstDemocracy"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; YearFirstDemocracy</span></span>
<span><span class="co">#&gt;    0 1960 1961 1962 1965 1966 1970 1972 1973 1974 1975 1976 1977 1978 1979 1980 </span></span>
<span><span class="co">#&gt;   42   33    2    1    1    5    5    2    2    1    3    2    3    4    2    3 </span></span>
<span><span class="co">#&gt; 1981 1982 1983 1990 1991 1992 1993 1994 1995 1997 1999 2000 2002 2003 2004 2005 </span></span>
<span><span class="co">#&gt;    2    4    1    7    9    6   11    8    2    1    2    3    1    1    1    2 </span></span>
<span><span class="co">#&gt; 2007 2008 2010 </span></span>
<span><span class="co">#&gt;    1    1    1</span></span></code></pre></div>
<p>This shows that there are 35 groups in the data, including the group
of 42 countries that are never democracies in the period 1960-2010. The
group of countries whose <code>YearFirstDemocracy</code> is 1960 will be
dropped from the analysis since they enter the analysis as democracies
already. I would expect results from no more than 33 groups. They would
have different lengths of dynamic effects. For example, the
group/country that democratizes in 2010 will only produce the
instantaneous effect.</p>
<p>To produce the unconditional differences-in-differences estimates
with the <code>did</code> package:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out</span> <span class="op">&lt;-</span> <span class="fu">did</span><span class="fu">::</span><span class="fu"><a href="https://bcallaway11.github.io/did/reference/att_gt.html" class="external-link">att_gt</a></span><span class="op">(</span>yname <span class="op">=</span> <span class="st">"gdppercapitaconstant2000us"</span>,</span>
<span>              gname <span class="op">=</span> <span class="st">"YearFirstDemocracy"</span>,</span>
<span>              idname <span class="op">=</span> <span class="st">"wbnum"</span>,</span>
<span>              tname <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>              xformla <span class="op">=</span> <span class="op">~</span><span class="fl">1</span>,</span>
<span>              data <span class="op">=</span> <span class="va">demgdp</span>,</span>
<span>              panel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>              control_group <span class="op">=</span> <span class="st">"notyettreated"</span>,</span>
<span>              est_method <span class="op">=</span> <span class="st">"reg"</span></span>
<span>              <span class="op">)</span></span></code></pre></div>
<p>Messages and warnings were turned off for aesthetic purposes.
However, the unbalanced nature of the panel will produce many messages.
The warnings will related to small groups, which is unavoidable because
of the sparsity of democratizations that occur.</p>
<p>There are a large number of differences-in-difference estimates
produce by the previous operation. Because this is overwhelming it is
useful to aggregate this information. I aggregate the effects into the
group level here, but many other aggregations are possible. Refer to
other functions in the <a href="https://bcallaway11.github.io/did/" class="external-link">did</a> package.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">group_effects</span> <span class="op">&lt;-</span> <span class="fu">did</span><span class="fu">::</span><span class="fu"><a href="https://bcallaway11.github.io/did/reference/aggte.html" class="external-link">aggte</a></span><span class="op">(</span><span class="va">out</span>, type <span class="op">=</span> <span class="st">"group"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Arrange these effects into a table</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">group_effects_df</span> <span class="op">&lt;-</span> <span class="fu">didwrappers</span><span class="fu">::</span><span class="fu"><a href="../reference/aggite_table.html">aggite_table</a></span><span class="op">(</span><span class="va">group_effects</span><span class="op">)</span></span></code></pre></div>
<p>I plot these group effects. The dark green line are group effect. The
lighter green band around them is the uniform confidence interval, and
the green dots are the individual differences-in-differences effects
that were aggregated to produce the group-level estimates.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">group_effects</span><span class="op">$</span><span class="va">egt</span>, <span class="va">group_effects</span><span class="op">$</span><span class="va">att.egt</span>, col<span class="op">=</span><span class="st">"forestgreen"</span>, lwd<span class="op">=</span><span class="fl">5</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">6000</span>,<span class="fl">12000</span><span class="op">)</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Group-level effect on GDP per capita"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Time of democratization"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Growth effect of democracy by democratizing year"</span>,</span>
<span>     cex.main <span class="op">=</span> <span class="fl">1</span>,</span>
<span>     cex.lab <span class="op">=</span> <span class="fl">0.82</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">out</span><span class="op">$</span><span class="va">group</span>, <span class="va">out</span><span class="op">$</span><span class="va">att</span>, pch<span class="op">=</span><span class="fl">19</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="st">"olivedrab3"</span>,<span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">group_effects_df</span><span class="op">$</span><span class="va">egt</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">group_effects_df</span><span class="op">$</span><span class="va">egt</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">group_effects_df</span><span class="op">$</span><span class="va">lowci</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">group_effects_df</span><span class="op">$</span><span class="va">highci</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span> <span class="st">"forestgreen"</span>, alpha.f <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>, border <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span>,lty<span class="op">=</span><span class="fl">3</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="my-article_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<p>The overall effect and its significance can also be obtained.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Overall effect</span></span>
<span><span class="va">group_effects</span><span class="op">$</span><span class="va">overall.att</span></span>
<span><span class="co">#&gt; [1] 756.8741</span></span></code></pre></div>
<p>The 95% confidence interval</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Confidence interval</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"["</span>,<span class="va">group_effects</span><span class="op">$</span><span class="va">overall.att</span><span class="op">-</span><span class="fl">1.96</span><span class="op">*</span><span class="va">group_effects</span><span class="op">$</span><span class="va">overall.se</span>,<span class="st">","</span>, <span class="va">group_effects</span><span class="op">$</span><span class="va">overall.att</span><span class="op">+</span><span class="fl">1.96</span><span class="op">*</span><span class="va">group_effects</span><span class="op">$</span><span class="va">overall.se</span>,<span class="st">"]"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "[ 240.54681719526 , 1273.20141833828 ]"</span></span></code></pre></div>
<p>Overall democratization has a positive effect of GDP growth. But
there seems to be a great amount of heterogeneity. Some effects are
negative, but rarely significantly.</p>
</div>
<div class="section level2">
<h2 id="the-estimates-from-the-didwrappers-package">The estimates from the didwrappers package<a class="anchor" aria-label="anchor" href="#the-estimates-from-the-didwrappers-package"></a>
</h2>
<p>The <code>didwrappers</code> package maintains the syntax of the
<code>did</code> package. Its algorithm is slightly different. Instead
of calculating the individual differences-in-differences estimates at
the group level, it calculates those estimates at the unit level. In
this case, at the country level.</p>
<p>It also restricts the comparisons to be observed pre- and post-
treatment, so that units that were observed only pre-treatment or only
post-treatment are removed.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out_it</span> <span class="op">&lt;-</span> <span class="fu">didwrappers</span><span class="fu">::</span><span class="fu"><a href="../reference/att_it.html">att_it</a></span><span class="op">(</span>yname <span class="op">=</span> <span class="st">"gdppercapitaconstant2000us"</span>,</span>
<span>              gname <span class="op">=</span> <span class="st">"YearFirstDemocracy"</span>,</span>
<span>              idname <span class="op">=</span> <span class="st">"wbnum"</span>,</span>
<span>              tname <span class="op">=</span> <span class="st">"year"</span>,</span>
<span>              xformla <span class="op">=</span> <span class="op">~</span><span class="fl">1</span>,</span>
<span>              data <span class="op">=</span> <span class="va">demgdp</span>,</span>
<span>              panel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>              control_group <span class="op">=</span> <span class="st">"notyettreated"</span>,</span>
<span>              est_method <span class="op">=</span> <span class="st">"reg"</span></span>
<span>              <span class="op">)</span></span></code></pre></div>
<p>Group effects are found by aggregating the individual estimates to
the group level.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">group_effects_it</span> <span class="op">&lt;-</span> <span class="fu">didwrappers</span><span class="fu">::</span><span class="fu"><a href="../reference/aggite.html">aggite</a></span><span class="op">(</span><span class="va">out_it</span>, type <span class="op">=</span> <span class="st">"group"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">group_effects_it_df</span> <span class="op">&lt;-</span> <span class="fu">didwrappers</span><span class="fu">::</span><span class="fu"><a href="../reference/aggite_table.html">aggite_table</a></span><span class="op">(</span><span class="va">group_effects_it</span><span class="op">)</span></span></code></pre></div>
<p>Plotting the group effects:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">group_effects_it</span><span class="op">$</span><span class="va">egt</span>, <span class="va">group_effects_it</span><span class="op">$</span><span class="va">att.egt</span>, col<span class="op">=</span><span class="st">"forestgreen"</span>, lwd<span class="op">=</span><span class="fl">5</span>,</span>
<span>     type <span class="op">=</span> <span class="st">"l"</span>,</span>
<span>     ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4000</span>,<span class="fl">5000</span><span class="op">)</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Group-level effect on GDP per capita"</span>,</span>
<span>     xlab <span class="op">=</span> <span class="st">"Time of democratization"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Growth effect of democracy by democratizing year"</span>,</span>
<span>     cex.main <span class="op">=</span> <span class="fl">1</span>,</span>
<span>     cex.lab <span class="op">=</span> <span class="fl">0.82</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">out_it</span><span class="op">$</span><span class="va">group</span>, <span class="va">out_it</span><span class="op">$</span><span class="va">att</span>, pch<span class="op">=</span><span class="fl">19</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span><span class="st">"olivedrab3"</span>,<span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">group_effects_it_df</span><span class="op">$</span><span class="va">egt</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">group_effects_it_df</span><span class="op">$</span><span class="va">egt</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">group_effects_it_df</span><span class="op">$</span><span class="va">lowci</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">group_effects_it_df</span><span class="op">$</span><span class="va">highci</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/grDevices/adjustcolor.html" class="external-link">adjustcolor</a></span><span class="op">(</span> <span class="st">"forestgreen"</span>, alpha.f <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>, border <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h<span class="op">=</span><span class="fl">0</span>,lty<span class="op">=</span><span class="fl">3</span>,col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></code></pre></div>
<p><img src="my-article_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>There group level effects are quite different to the previous
estimates of the <code>did</code> package. There are some large negative
effects in addition to postive effects.</p>
<p>The overall effects is insignificant.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># overall effect</span></span>
<span><span class="va">group_effects_it</span><span class="op">$</span><span class="va">overall.att</span></span>
<span><span class="co">#&gt; [1] -202.018</span></span></code></pre></div>
<p>The 95% confidence interval</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Confidence interval</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"["</span>,<span class="va">group_effects_it</span><span class="op">$</span><span class="va">overall.att</span><span class="op">-</span><span class="fl">1.96</span><span class="op">*</span><span class="va">group_effects_it</span><span class="op">$</span><span class="va">overall.se</span>,<span class="st">","</span>, <span class="va">group_effects_it</span><span class="op">$</span><span class="va">overall.att</span><span class="op">+</span><span class="fl">1.96</span><span class="op">*</span><span class="va">group_effects_it</span><span class="op">$</span><span class="va">overall.se</span>,<span class="st">"]"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "[ -768.777967071686 , 364.741956033862 ]"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="comparison">Comparison<a class="anchor" aria-label="anchor" href="#comparison"></a>
</h2>
<p>What caused these differences?</p>
<p>Comparison of the group effects show that they produced quite
different effects. One of the biggest differences were for the 1970
group. We could look at this group in the years 1969 and 1970. First we
look at the treatment group in 1970. There are 5 countries in the
treatment group.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">demgdp</span><span class="op">[</span><span class="va">demgdp</span><span class="op">$</span><span class="va">YearFirstDemocracy</span><span class="op">==</span><span class="fl">1970</span> <span class="op">&amp;</span> <span class="va">demgdp</span><span class="op">$</span><span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1969</span>,<span class="fl">1970</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">8</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 Ã— 6</span></span></span>
<span><span class="co">#&gt;   country_name wbcode  year gdppercapitaconstant2000us   dem wbnum</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Germany      DEU     <span style="text-decoration: underline;">1</span>970                     <span style="text-decoration: underline;">11</span>895.     1    41</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Fiji         FJI     <span style="text-decoration: underline;">1</span>970                      <span style="text-decoration: underline;">1</span>382.     1    54</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> Ghana        GHA     <span style="text-decoration: underline;">1</span>969                       274.     0    59</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> Ghana        GHA     <span style="text-decoration: underline;">1</span>970                       294.     1    59</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> Ireland      IRL     <span style="text-decoration: underline;">1</span>970                      <span style="text-decoration: underline;">7</span>335.     1    74</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> Malta        MLT     <span style="text-decoration: underline;">1</span>970                      <span style="text-decoration: underline;">1</span>968.     1   108</span></span></code></pre></div>
<p>There are 5 countries that enter the analysis in 1970. However, only
Ghana is observed pre-democracy. Now consider the countries that might
be in the control group.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">demgdp</span><span class="op">[</span><span class="op">(</span><span class="va">demgdp</span><span class="op">$</span><span class="va">YearFirstDemocracy</span><span class="op">==</span><span class="fl">0</span><span class="op">|</span><span class="va">demgdp</span><span class="op">$</span><span class="va">YearFirstDemocracy</span><span class="op">&gt;</span><span class="fl">1970</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">demgdp</span><span class="op">$</span><span class="va">year</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1969</span>,<span class="fl">1970</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">8</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 106 Ã— 6</span></span></span>
<span><span class="co">#&gt;    country_name wbcode  year gdppercapitaconstant2000us   dem wbnum</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>                      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> Argentina    ARG     <span style="text-decoration: underline;">1</span>969                      <span style="text-decoration: underline;">6</span>515.     0     3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> Argentina    ARG     <span style="text-decoration: underline;">1</span>970                      <span style="text-decoration: underline;">6</span>611.     0     3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> Burundi      BDI     <span style="text-decoration: underline;">1</span>969                       106.     0     9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> Burundi      BDI     <span style="text-decoration: underline;">1</span>970                       127.     0     9</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> Benin        BEN     <span style="text-decoration: underline;">1</span>969                       292.     0    11</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> Benin        BEN     <span style="text-decoration: underline;">1</span>970                       292.     0    11</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> Burkina Faso BFA     <span style="text-decoration: underline;">1</span>969                       139.     0    12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> Burkina Faso BFA     <span style="text-decoration: underline;">1</span>970                       137.     0    12</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> Bolivia      BOL     <span style="text-decoration: underline;">1</span>969                       954.     0    20</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> Bolivia      BOL     <span style="text-decoration: underline;">1</span>970                       927.     0    20</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 96 more rows</span></span></span></code></pre></div>
<p>Swaziland and Cuba are observed only in 1970. Otherwise, all other
countries in the control group in 1970 are observed across both
years.</p>
<p>Here are the estimates, and counts from the <code>didwrappers</code>
package for the 1969-1970 and the 1969-1971 differences-in-differences
estimate.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/attit_table.html">attit_table</a></span><span class="op">(</span><span class="va">out_it</span><span class="op">)</span><span class="op">[</span><span class="va">out_it</span><span class="op">$</span><span class="va">group</span><span class="op">==</span><span class="fl">1970</span> <span class="op">&amp;</span> <span class="va">out_it</span><span class="op">$</span><span class="va">t</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1970</span>,<span class="fl">1971</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>,<span class="st">"group"</span>,<span class="st">"t"</span>,<span class="st">"att"</span>,<span class="st">"count"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;       id group    t        att count</span></span>
<span><span class="co">#&gt; 1210  41  1970 1970         NA     0</span></span>
<span><span class="co">#&gt; 1211  41  1970 1971         NA     0</span></span>
<span><span class="co">#&gt; 1560  54  1970 1970         NA     0</span></span>
<span><span class="co">#&gt; 1561  54  1970 1971         NA     0</span></span>
<span><span class="co">#&gt; 1660  59  1970 1970  -53.40957    53</span></span>
<span><span class="co">#&gt; 1661  59  1970 1971 -111.43377    53</span></span>
<span><span class="co">#&gt; 2260  74  1970 1970         NA     0</span></span>
<span><span class="co">#&gt; 2261  74  1970 1971         NA     0</span></span>
<span><span class="co">#&gt; 3160 108  1970 1970         NA     0</span></span>
<span><span class="co">#&gt; 3161 108  1970 1971         NA     0</span></span></code></pre></div>
<p>The <code>did</code> package doesnâ€™t produce the counts, but the
corresponding estimates for the 1969-1970, and 1969-1971
differences-in-differences estimates are</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dfit</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>group<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">group</span>,t<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">t</span>,att<span class="op">=</span><span class="va">out</span><span class="op">$</span><span class="va">att</span><span class="op">)</span></span>
<span><span class="va">dfit</span><span class="op">[</span><span class="va">dfit</span><span class="op">$</span><span class="va">group</span><span class="op">==</span><span class="fl">1970</span> <span class="op">&amp;</span> <span class="va">dfit</span><span class="op">$</span><span class="va">t</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1970</span>,<span class="fl">1971</span><span class="op">)</span>,<span class="op">]</span></span>
<span><span class="co">#&gt;     group    t      att</span></span>
<span><span class="co">#&gt; 210  1970 1970 4236.862</span></span>
<span><span class="co">#&gt; 211  1970 1971 4297.849</span></span></code></pre></div>
<p>The 1969-1970 difference-in-difference estimates suffer from a severe
case of imbalance. The <code>did</code> algorithm uses all 5 countries
in the 1970 group. But the <code>didwrappers</code> estimates only use
Ghana in the group because it is the only country that is observed both
in 1960 and 1970. The instantaneous effect for the <code>did</code>
estimate is calculated by differencing against only the 1969 value in
Ghana, resulting in a large positive effect for this group as richer
countries such as Germany and Ireland suddenly appear in 1970 without
being seen in 1969.</p>
<p>Which type of estimator is more appropriate depends on the
â€˜balancednessâ€™ in the data. With unbalanced data, the <code>did</code>
algorithm implements a repeated cross-section type of analysis. There,
the composition of the treatment group pre- and post-treatment does not
have to be equal. This is appropriate in individual-level records
because heterogeneity across individuals are likely to be minimal. In an
application with countries, such an assumption may be too strong. Ghana
and Germany are quite different to each other. In the case of Germany
(refers to West Germany), its entry into the sample is not the same as
democratization. A more serious analysis of democratization would need
to check each of the dates in <code>YearFirstDemocracy</code>. This
consideration matters for the control group as well. In this particular
case, only two countries suddenly appear in 1970, so the effect of
imbalance is small.</p>
<p>Ensuring the composition of units pre- and post-treatment is equal
results in sample losses. In this case, Germany, Fiji, Ireland, and
Malta will all be lost due to lack of pre-treatment information. This is
an important trade-off to consider.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ransi Clark.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
